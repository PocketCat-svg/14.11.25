# ---–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ —Å–æ–∑–¥–∞–µ–º –±–∞–∑—É---

import sqlite3 # –ø–æ–¥–∫–ª—é—á–∞–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö SQLite

import json #–ø–æ–¥–∫–ª—é—á–∞–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å JSON —Ñ–∞–π–ª–∞–º–∏

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã 
conn = sqlite3.connect('database.db') 
#–°–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª students.db(–µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç) –∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –Ω–µ–º—É
# conn - —ç—Ç–æ –Ω–∞—à–µ "–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ" –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –∫–∞–∫ –ø—Ä–æ–≤–æ–¥ –º–µ–∂–¥—É –ø—Ä–æ–≥—Ä–∞–º–º–æ–π –∏ –±–∞–∑–æ–π
# students.db - —ç—Ç–æ —Ñ–∞–π–ª, –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—É–¥–µ–Ω—Ç–∞—Ö, –∫–∞–∫ –≤ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –∫–∞—Ä—Ç–æ—Ç–µ–∫–µ(–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö).


cursor = conn.cursor() 
# –°–æ–∑–¥–∞–µ—Ç "–∫—É—Ä—Å–æ—Ä" - —ç—Ç–æ –∫–∞–∫ –Ω–∞—à–∞ —Ä—É–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –≤–Ω—É—Ç—Ä–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
#–ß–µ—Ä–µ–∑ –∫—É—Ä—Å–æ—Ä –º—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º SQL-–∑–∞–ø—Ä–æ—Å—ã


print("‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞!")
# –≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
# –°–º–∞–π–ª–∏–∫ ‚úÖ —á—Ç–æ–±—ã –±—ã–ª–æ –ø–æ–Ω—è—Ç–Ω–µ–µ


# ---–°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É---

cursor.execute('''
CREATE TABLE IF NOT EXISTS students (
    id INTEGER PRIMARY KEY,
    name TEXT NOT NULL,
    age INTEGER,
    faculty TEXT
)
''')
# cursor.execute() - –≥–æ–≤–æ—Ä–∏—Ç "–≤—ã–ø–æ–ª–Ω–∏ —ç—Ç—É –∫–æ–º–∞–Ω–¥—É –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"
# CREATE TABLE IF NOT EXISTS students - —Å–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É "students", –µ—Å–ª–∏ –µ—ë –µ—â–µ –Ω–µ—Ç
# –í–Ω—É—Ç—Ä–∏ —Å–∫–æ–±–æ–∫ –æ–ø–∏—Å—ã–≤–∞–µ–º –∫–æ–ª–æ–Ω–∫–∏ —Ç–∞–±–ª–∏—Ü—ã:
# id INTEGER PRIMARY KEY - –Ω–æ–º–µ—Ä —Å—Ç—É–¥–µ–Ω—Ç–∞ (–≥–ª–∞–≤–Ω—ã–π –∫–ª—é—á, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è)
# name TEXT NOT NULL - –∏–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞, –∏ —É—Ç–æ—á–Ω–µ–Ω–∏–µ, —á—Ç–æ —Ç–µ–∫—Å—Ç, –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º
# age INTEGER - –≤–æ–∑—Ä–∞—Å—Ç (—á–∏—Å–ª–æ)
# faculty TEXT - —Ñ–∞–∫—É–ª—å—Ç–µ—Ç (—Ç–µ–∫—Å—Ç)


conn.commit() # –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

print("‚úÖ –¢–∞–±–ª–∏—Ü–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å–æ–∑–¥–∞–Ω–∞!")


# ---–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ JSON---

# –ß–∏—Ç–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ JSON —Ñ–∞–π–ª–∞
with open('students.json', 'r', encoding='utf-8') as file: # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ —á–∏—Ç–∞–µ–º —á—Ç–æ —Ç–∞–º –≤–Ω—É—Ç—Ä–∏
    students_data = json.load(file)      # with open(...) - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª students.json –¥–ª—è —á—Ç–µ–Ω–∏—è ('r')
                                         # encoding='utf-8' - –ø—Ä–∞–≤–∏–ª—å–Ω–æ —á–∏—Ç–∞–µ—Ç —Ä—É—Å—Å–∫–∏–µ –±—É–∫–≤—ã
                                         # json.load(file) - —á–∏—Ç–∞–µ—Ç JSON —Ñ–∞–π–ª –∏ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –≤ Python-–æ–±—ä–µ–∫—Ç
                                         # students_data - —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ JSON —Ñ–∞–π–ª–∞
# –í—Å—Ç–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É
for student in students_data: # –ü–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –∫–∞–∂–¥–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏–∑ –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ø—Ä–æ—á–∏—Ç–∞–ª–∏ –∏ -
# - –∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–¥ –Ω–∏–∂–µ
    cursor.execute('''
    INSERT OR REPLACE INTO students (id, name, age, faculty)
    VALUES (?, ?, ?, ?)
    ''', (student['id'], student['name'], student['age'], student['faculty']))
# cursor.execute() - –≥–æ–≤–æ—Ä–∏—Ç "–≤—ã–ø–æ–ª–Ω–∏ —ç—Ç—É –∫–æ–º–∞–Ω–¥—É –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"
# INSERT OR REPLACE - –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏–ª–∏ –∑–∞–º–µ–Ω—è–µ—Ç –µ—Å–ª–∏ —Ç–∞–∫–æ–π ID —É–∂–µ –µ—Å—Ç—å
# (id, name, age, faculty) - —É–∫–∞–∑—ã–≤–∞–µ—Ç –≤ –∫–∞–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –≤—Å—Ç–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
# VALUES (?, ?, ?, ?) - –º–µ—Å—Ç–∞ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
# (student['id'], student['name'], ...) - –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ JSON


conn.commit() # –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
print("‚úÖ –î–∞–Ω–Ω—ã–µ –∏–∑ JSON –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ –±–∞–∑—É!")

# –§–£–ù–ö–¶–ò–ò CRUD
# CRUD - —ç—Ç–æ 4 –æ—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Å –ª—é–±—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏: –°–æ–∑–¥–∞—Ç—å, –ü—Ä–æ—á–∏—Ç–∞—Ç—å, –û–±–Ω–æ–≤–∏—Ç—å, –£–¥–∞–ª–∏—Ç—å
                                                                        # Create, Read, Update, Delete
# CREATE - –°–û–ó–î–ê–¢–¨
def create_student(name, age, faculty):
    """–î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ –±–∞–∑—É"""
    cursor.execute('''
    INSERT INTO students (name, age, faculty)
    VALUES (?, ?, ?)
    ''', (name, age, faculty))
    conn.commit()
    print(f"‚úÖ –°—Ç—É–¥–µ–Ω—Ç {name} –¥–æ–±–∞–≤–ª–µ–Ω!")

# READ - –ü–†–û–ß–ò–¢–ê–¢–¨
def read_students():
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤"""
    cursor.execute('SELECT * FROM students')
    students = cursor.fetchall()
    
    print("\nüìã –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:")
    print("-" * 40)
    for student in students:
        print(f"ID: {student[0]}, –ò–º—è: {student[1]}, –í–æ–∑—Ä–∞—Å—Ç: {student[2]}, –§–∞–∫—É–ª—å—Ç–µ—Ç: {student[3]}")
    print("-" * 40)
    return students
# UPDATE - –û–ë–ù–û–í–ò–¢–¨
def update_student(student_id, new_name=None, new_age=None, new_faculty=None):
    """–ò–∑–º–µ–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç–∞"""
    if new_name:
        cursor.execute('UPDATE students SET name = ? WHERE id = ?', (new_name, student_id))
    if new_age:
        cursor.execute('UPDATE students SET age = ? WHERE id = ?', (new_age, student_id))
    if new_faculty:
        cursor.execute('UPDATE students SET faculty = ? WHERE id = ?', (new_faculty, student_id))
    
    conn.commit()
    print(f"‚úÖ –î–∞–Ω–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç–∞ —Å ID {student_id} –æ–±–Ω–æ–≤–ª–µ–Ω—ã!")

# DELETE - –£–î–ê–õ–ò–¢–¨
def delete_student(student_id):
    """–£–¥–∞–ª—è–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞ –ø–æ ID"""
    cursor.execute('DELETE FROM students WHERE id = ?', (student_id,))
    conn.commit()
    print(f"‚úÖ –°—Ç—É–¥–µ–Ω—Ç —Å ID {student_id} —É–¥–∞–ª–µ–Ω!")

# ---–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ---
# –¢–ï–°–¢–ò–†–£–ï–ú –§–£–ù–ö–¶–ò–ò:

# 1. –°–º–æ—Ç—Ä–∏–º –≤—Å–µ—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
#read_students()

# 2. –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞
#create_student("–ò–≤–∞–Ω –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á", 23, "–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ")

# 3. –°–Ω–æ–≤–∞ —Å–º–æ—Ç—Ä–∏–º –≤—Å–µ—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
#read_students()

# 4. –ò–∑–º–µ–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç–∞
#update_student(1, new_age=40)  # –ú–µ–Ω—è–µ–º –≤–æ–∑—Ä–∞—Å—Ç 

# 5. –£–¥–∞–ª—è–µ–º —Å—Ç—É–¥–µ–Ω—Ç–∞
#delete_student(5)  # –£–¥–∞–ª—è–µ–º –∫–æ–≥–æ –ª–∏–±–æ

# 6. –§–∏–Ω–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫
#read_students()

# –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–π
#conn.close()


